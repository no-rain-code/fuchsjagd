<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script type="text/javascript" charset="utf-8" src="phonegap-1.2.0.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript" src="fuchsjagd.js"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body style="font: 75% Lucida Grande, Trebuchet MS;margin:0">
    Latitude: <div id="lat">Loading Latitude...</div>
    Longitude: <div id="lng">Loading Longitude...</div>
    Heading: <div id="head">Loading Heading...</div>
    <div id="err"></div>
    <div id="targets" class="targets">
	</div>
    <script>
    
      var options = { frequency: 500 };
      // Schaffhausen 
      var searchPosition0 = { coords : { latitude : 47.707769, longitude : 8.641434 }};
      // Basel 
      var searchPosition1 = { coords : { latitude : 47.557422, longitude : 7.592572 }};
      // Lugano
      var searchPosition2 = { coords : { latitude : 46.006508, longitude : 8.952312 }};
      // Genf
      var searchPosition3 = { coords : { latitude : 46.198391, longitude : 6.142291 }};
      // Chur
      var searchPosition4 = { coords : { latitude : 46.857264, longitude : 9.526734 }};
      
      // load
      var targets = new Array(new target(searchPosition0, "Schaffhausen"),
      						  new target(searchPosition1, "Basel"),
      						  new target(searchPosition2, "Lugano"),
      						  new target(searchPosition3, "Genf"),
      						  new target(searchPosition4, "Chur")
      						 );
      
      var bearingToPosition = 0;
     // var myHeading = 0;
	document.addEventListener("deviceready", onDeviceReady, false);    
    
      function onDeviceReady() {
	      if (navigator.geolocation) {
	        var elementLat = document.getElementById('lat');
	        var elementLng = document.getElementById('lng');
	        elementLat.innerHTML = 'Loading Latitude..';
	        elementLng.innerHTML = 'Loading Longitude..';
	        navigator.geolocation.getCurrentPosition(showPosition, onError);
	        // also monitor position as it changes
	        navigator.geolocation.watchPosition(showPosition);
	      } else {
	        onError();
	      }
	      
	      if (navigator.compass) {
	      	var elementHead = document.getElementById('head');
	      	elementHead.innerHTML = 'Loading Heading';
	      	navigator.compass.getCurrentHeading(showHeading, onErrorHeading, options);
	      	// also monitor heading as it changes
	      	navigator.compass.watchHeading(showHeading, onErrorHeading, options);
	      } else {
	        onErrorHeading();
	      }
	      
	      var tarElement = document.getElementById('targets');
	      for (var i = 0; i < targets.length; i++) {
	      
	      	tarElement.innerHTML = tarElement.innerHTML + makeTarget(targets[i].name);
	      }
      }
      
      function showPosition(position) {
        var lat = position.coords.latitude;
        var lng = position.coords.longitude;
        var elementLat = document.getElementById('lat');
        var elementLng = document.getElementById('lng');
        elementLat.innerHTML = lat;
        elementLng.innerHTML = lng;
        for (var i = 0; i < targets.length; i++) {
        	targets[i].update(position);
        }
      }
      
      function showHeading(heading) {
        var head = heading.magneticHeading;
        var elementHead = document.getElementById('head');
        elementHead.innerHTML = head;
        
        for (var i = 0; i < targets.length; i++) {
        	var strength = targets[i].getStrength(head);
        	document.getElementById(targets[i].name).style.width = strength+"%";
        }
      }
    </script>
  </body>
</html>â€‹